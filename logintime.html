<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Login & Logout Time</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

<style>
body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
  /* background: linear-gradient(135deg, #e3ecf5, #f6f8fb); */
  display: flex;
  align-items: center;
  justify-content: center;
}

/* WRAPPER */
.wrapper {
  width: 100%;
  max-width: 820px;
  padding: 20px;
}

/* CARD */
.time-card {
  background: linear-gradient(160deg, #315f86, #467eb1);
  color: #fff;
  border-radius: 22px;
  padding: 26px 22px 24px;
  text-align: center;
  box-shadow: 0 18px 45px rgba(0,0,0,0.18);
  position: relative;
  overflow: hidden;
}

/* SOFT GLOW */
.time-card::after {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at top right, rgba(255,255,255,0.25), transparent 60%);
  pointer-events: none;
}

.time-title {
  font-size: 0.85rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  opacity: 0.9;
}

.time-value {
  font-size: 1.65rem;
  font-weight: 700;
  margin: 8px 0 4px;
}

.day-text {
  font-size: 0.9rem;
  opacity: 0.85;
  margin-bottom: 14px;
}

.time-card button {
  border-radius: 999px;
  padding: 6px 28px;
  font-size: 0.9rem;
  font-weight: 500;
}

/* STATUS */
.status-text {
  margin-top: 26px;
  text-align: center;
  font-size: 1.05rem;
  color: #2f2f2f;
}

/* MOBILE */
@media (max-width: 576px) {
  .time-value {
    font-size: 1.45rem;
  }
}
</style>
</head>

<body>

<div class="wrapper">
  <div class="row g-4 justify-content-center">
<div id="sessionStatus" class="alert alert-light border small">
  Loading session status...
</div>

    <!-- LOGIN -->
    <!-- <div class="col-12 col-md-6">
      <div class="time-card">
        <div class="time-title">Login Time</div>
        <div class="time-value" id="loginTime">--:--:--</div>
        <div class="day-text" id="loginDay"></div>
        <button class="btn btn-light btn-sm" disabled>Logged In</button>
      </div>
    </div> -->

    <!-- LOGOUT -->
    <!-- <div class="col-12 col-md-6">
      <div class="time-card">
        <div class="time-title">Logout Time</div>
        <div class="time-value" id="logoutTime">--:--:--</div>
        <div class="day-text" id="logoutDay"></div>
        <button class="btn btn-outline-light btn-sm" id="btnLogout">
          Logout
        </button>
      </div>
    </div> -->

  </div>

  <div class="status-text" id="statusMessage"></div>
</div>

<script src="js/config.js"></script>
<script>
async function loadSessionStatus() {
  const token = localStorage.getItem("authToken");
  if (!token) return;

  const res = await fetch(`${API_BASE_URL}/api/login/employee-session-status`, {
    headers: {
      Authorization: "Bearer " + token
    }
  });

  const result = await res.json();
  const el = document.getElementById("sessionStatus");

  if (!result.success || !result.session) {
    el.innerText = "‚ÑπÔ∏è No active session";
    return;
  }

  const { login_time, logout_time, logout_type } = result.session;

  const loginIST = new Date(login_time).toLocaleTimeString("en-IN", {
    timeZone: "Asia/Kolkata",
    hour: "2-digit",
    minute: "2-digit",
    hour12: true
  });

  if (!logout_time) {
    el.innerHTML = `
      üü¢ <strong>Logged in at ${loginIST}</strong><br>
      ‚è∞ Auto logout at <strong>6:30 PM</strong>
    `;
  } else {
    const logoutIST = new Date(logout_time).toLocaleTimeString("en-IN", {
      timeZone: "Asia/Kolkata",
      hour: "2-digit",
      minute: "2-digit",
      hour12: true
    });

    el.innerHTML = `
      üî¥ <strong>Logged out at ${logoutIST}</strong>
      <small class="text-muted">(${logout_type})</small>
    `;
  }
}

document.addEventListener("DOMContentLoaded", loadSessionStatus);








let loginDate = new Date();
let timer = null;

const loginTimeEl = document.getElementById("loginTime");
const loginDayEl = document.getElementById("loginDay");
const logoutTimeEl = document.getElementById("logoutTime");
const logoutDayEl = document.getElementById("logoutDay");
const statusMessageEl = document.getElementById("statusMessage");
const btnLogout = document.getElementById("btnLogout");

function formatTime(date) {
  const days = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
  let h = date.getHours();
  const ampm = h >= 12 ? "PM" : "AM";
  h = h % 12 || 12;
  const m = String(date.getMinutes()).padStart(2,"0");
  const s = String(date.getSeconds()).padStart(2,"0");

  return {
    time: `${h}:${m}:${s} ${ampm}`,
    day: days[date.getDay()]
  };
}

/* IMMEDIATE SET */
const loginFormatted = formatTime(loginDate);
loginTimeEl.textContent = loginFormatted.time;
loginDayEl.textContent = loginFormatted.day;
logoutDayEl.textContent = loginFormatted.day;

/* LIVE LOGOUT TIMER */
function startTimer() {
  timer = setInterval(() => {
    const now = new Date();
    logoutTimeEl.textContent = formatTime(now).time;
  }, 1000);
}
startTimer();

/* LOGOUT */
btnLogout.addEventListener("click", () => {
  clearInterval(timer);

  const logoutDate = new Date();
  const diff = Math.floor((logoutDate - loginDate) / 1000);

  const hrs = Math.floor(diff / 3600);
  const mins = Math.floor((diff % 3600) / 60);
  const secs = diff % 60;

  const { time, day } = formatTime(logoutDate);
  logoutTimeEl.textContent = time;
  logoutDayEl.textContent = day;

  statusMessageEl.innerHTML =
    `‚úÖ Successfully logged out.<br>
     Your work duration today is
     <strong>${hrs} hrs ${mins} mins ${secs} secs</strong>.`;

  btnLogout.disabled = true;
});
</script>

</body>
</html>
